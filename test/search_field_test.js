import d3 from 'd3';
import {SearchField} from '../app/scripts/search_field.js';
import {ChromosomeInfo} from '../app/scripts/ChromosomeInfo.js';

let chromInfo = JSON.parse('{"cumPositions":[{"id":0,"chr":"chr1","pos":0},{"id":1,"chr":"chr2","pos":249250621},{"id":2,"chr":"chr3","pos":492449994},{"id":3,"chr":"chr4","pos":690472424},{"id":4,"chr":"chr5","pos":881626700},{"id":5,"chr":"chr6","pos":1062541960},{"id":6,"chr":"chr7","pos":1233657027},{"id":7,"chr":"chrX","pos":1392795690},{"id":8,"chr":"chr8","pos":1548066250},{"id":9,"chr":"chr9","pos":1694430272},{"id":10,"chr":"chr10","pos":1835643703},{"id":11,"chr":"chr11","pos":1971178450},{"id":12,"chr":"chr12","pos":2106184966},{"id":13,"chr":"chr13","pos":2240036861},{"id":14,"chr":"chr14","pos":2355206739},{"id":15,"chr":"chr15","pos":2462556279},{"id":16,"chr":"chr16","pos":2565087671},{"id":17,"chr":"chr17","pos":2655442424},{"id":18,"chr":"chr18","pos":2736637634},{"id":19,"chr":"chr20","pos":2814714882},{"id":20,"chr":"chrY","pos":2877740402},{"id":21,"chr":"chr19","pos":2937113968},{"id":22,"chr":"chr22","pos":2996242951},{"id":23,"chr":"chr21","pos":3047547517},{"id":24,"chr":"chr6_ssto_hap7","pos":3095677412},{"id":25,"chr":"chr6_mcf_hap5","pos":3100605979},{"id":26,"chr":"chr6_cox_hap2","pos":3105439377},{"id":27,"chr":"chr6_mann_hap4","pos":3110234748},{"id":28,"chr":"chr6_apd_hap1","pos":3114918011},{"id":29,"chr":"chr6_qbl_hap6","pos":3119540301},{"id":30,"chr":"chr6_dbb_hap3","pos":3124152285},{"id":31,"chr":"chr17_ctg5_hap1","pos":3128762681},{"id":32,"chr":"chr4_ctg9_hap1","pos":3130443509},{"id":33,"chr":"chr1_gl000192_random","pos":3131033935},{"id":34,"chr":"chrUn_gl000225","pos":3131581431},{"id":35,"chr":"chr4_gl000194_random","pos":3131792604},{"id":36,"chr":"chr4_gl000193_random","pos":3131984073},{"id":37,"chr":"chr9_gl000200_random","pos":3132173862},{"id":38,"chr":"chrUn_gl000222","pos":3132360897},{"id":39,"chr":"chrUn_gl000212","pos":3132547758},{"id":40,"chr":"chr7_gl000195_random","pos":3132734616},{"id":41,"chr":"chrUn_gl000223","pos":3132917512},{"id":42,"chr":"chrUn_gl000224","pos":3133097967},{"id":43,"chr":"chrUn_gl000219","pos":3133277660},{"id":44,"chr":"chr17_gl000205_random","pos":3133456858},{"id":45,"chr":"chrUn_gl000215","pos":3133631446},{"id":46,"chr":"chrUn_gl000216","pos":3133803991},{"id":47,"chr":"chrUn_gl000217","pos":3133976285},{"id":48,"chr":"chr9_gl000199_random","pos":3134148434},{"id":49,"chr":"chrUn_gl000211","pos":3134318308},{"id":50,"chr":"chrUn_gl000213","pos":3134484874},{"id":51,"chr":"chrUn_gl000220","pos":3134649113},{"id":52,"chr":"chrUn_gl000218","pos":3134810915},{"id":53,"chr":"chr19_gl000209_random","pos":3134972062},{"id":54,"chr":"chrUn_gl000221","pos":3135131231},{"id":55,"chr":"chrUn_gl000214","pos":3135286628},{"id":56,"chr":"chrUn_gl000228","pos":3135424346},{"id":57,"chr":"chrUn_gl000227","pos":3135553466},{"id":58,"chr":"chr1_gl000191_random","pos":3135681840},{"id":59,"chr":"chr19_gl000208_random","pos":3135788273},{"id":60,"chr":"chr9_gl000198_random","pos":3135880962},{"id":61,"chr":"chr17_gl000204_random","pos":3135971047},{"id":62,"chr":"chrUn_gl000233","pos":3136052357},{"id":63,"chr":"chrUn_gl000237","pos":3136098298},{"id":64,"chr":"chrUn_gl000230","pos":3136144165},{"id":65,"chr":"chrUn_gl000242","pos":3136187856},{"id":66,"chr":"chrUn_gl000243","pos":3136231379},{"id":67,"chr":"chrUn_gl000241","pos":3136274720},{"id":68,"chr":"chrUn_gl000236","pos":3136316872},{"id":69,"chr":"chrUn_gl000240","pos":3136358806},{"id":70,"chr":"chr17_gl000206_random","pos":3136400739},{"id":71,"chr":"chrUn_gl000232","pos":3136441740},{"id":72,"chr":"chrUn_gl000234","pos":3136482392},{"id":73,"chr":"chr11_gl000202_random","pos":3136522923},{"id":74,"chr":"chrUn_gl000238","pos":3136563026},{"id":75,"chr":"chrUn_gl000244","pos":3136602965},{"id":76,"chr":"chrUn_gl000248","pos":3136642894},{"id":77,"chr":"chr8_gl000196_random","pos":3136682680},{"id":78,"chr":"chrUn_gl000249","pos":3136721594},{"id":79,"chr":"chrUn_gl000246","pos":3136760096},{"id":80,"chr":"chr17_gl000203_random","pos":3136798250},{"id":81,"chr":"chr8_gl000197_random","pos":3136835748},{"id":82,"chr":"chrUn_gl000245","pos":3136872923},{"id":83,"chr":"chrUn_gl000247","pos":3136909574},{"id":84,"chr":"chr9_gl000201_random","pos":3136945996},{"id":85,"chr":"chrUn_gl000235","pos":3136982144},{"id":86,"chr":"chrUn_gl000239","pos":3137016618},{"id":87,"chr":"chr21_gl000210_random","pos":3137050442},{"id":88,"chr":"chrUn_gl000231","pos":3137078124},{"id":89,"chr":"chrUn_gl000229","pos":3137105510},{"id":90,"chr":"chrM","pos":3137125423},{"id":91,"chr":"chrUn_gl000226","pos":3137141994},{"id":92,"chr":"chr18_gl000207_random","pos":3137157002}],"chrPositions":{"chr1":{"id":0,"chr":"chr1","pos":0},"chr2":{"id":1,"chr":"chr2","pos":249250621},"chr3":{"id":2,"chr":"chr3","pos":492449994},"chr4":{"id":3,"chr":"chr4","pos":690472424},"chr5":{"id":4,"chr":"chr5","pos":881626700},"chr6":{"id":5,"chr":"chr6","pos":1062541960},"chr7":{"id":6,"chr":"chr7","pos":1233657027},"chrX":{"id":7,"chr":"chrX","pos":1392795690},"chr8":{"id":8,"chr":"chr8","pos":1548066250},"chr9":{"id":9,"chr":"chr9","pos":1694430272},"chr10":{"id":10,"chr":"chr10","pos":1835643703},"chr11":{"id":11,"chr":"chr11","pos":1971178450},"chr12":{"id":12,"chr":"chr12","pos":2106184966},"chr13":{"id":13,"chr":"chr13","pos":2240036861},"chr14":{"id":14,"chr":"chr14","pos":2355206739},"chr15":{"id":15,"chr":"chr15","pos":2462556279},"chr16":{"id":16,"chr":"chr16","pos":2565087671},"chr17":{"id":17,"chr":"chr17","pos":2655442424},"chr18":{"id":18,"chr":"chr18","pos":2736637634},"chr20":{"id":19,"chr":"chr20","pos":2814714882},"chrY":{"id":20,"chr":"chrY","pos":2877740402},"chr19":{"id":21,"chr":"chr19","pos":2937113968},"chr22":{"id":22,"chr":"chr22","pos":2996242951},"chr21":{"id":23,"chr":"chr21","pos":3047547517},"chr6_ssto_hap7":{"id":24,"chr":"chr6_ssto_hap7","pos":3095677412},"chr6_mcf_hap5":{"id":25,"chr":"chr6_mcf_hap5","pos":3100605979},"chr6_cox_hap2":{"id":26,"chr":"chr6_cox_hap2","pos":3105439377},"chr6_mann_hap4":{"id":27,"chr":"chr6_mann_hap4","pos":3110234748},"chr6_apd_hap1":{"id":28,"chr":"chr6_apd_hap1","pos":3114918011},"chr6_qbl_hap6":{"id":29,"chr":"chr6_qbl_hap6","pos":3119540301},"chr6_dbb_hap3":{"id":30,"chr":"chr6_dbb_hap3","pos":3124152285},"chr17_ctg5_hap1":{"id":31,"chr":"chr17_ctg5_hap1","pos":3128762681},"chr4_ctg9_hap1":{"id":32,"chr":"chr4_ctg9_hap1","pos":3130443509},"chr1_gl000192_random":{"id":33,"chr":"chr1_gl000192_random","pos":3131033935},"chrUn_gl000225":{"id":34,"chr":"chrUn_gl000225","pos":3131581431},"chr4_gl000194_random":{"id":35,"chr":"chr4_gl000194_random","pos":3131792604},"chr4_gl000193_random":{"id":36,"chr":"chr4_gl000193_random","pos":3131984073},"chr9_gl000200_random":{"id":37,"chr":"chr9_gl000200_random","pos":3132173862},"chrUn_gl000222":{"id":38,"chr":"chrUn_gl000222","pos":3132360897},"chrUn_gl000212":{"id":39,"chr":"chrUn_gl000212","pos":3132547758},"chr7_gl000195_random":{"id":40,"chr":"chr7_gl000195_random","pos":3132734616},"chrUn_gl000223":{"id":41,"chr":"chrUn_gl000223","pos":3132917512},"chrUn_gl000224":{"id":42,"chr":"chrUn_gl000224","pos":3133097967},"chrUn_gl000219":{"id":43,"chr":"chrUn_gl000219","pos":3133277660},"chr17_gl000205_random":{"id":44,"chr":"chr17_gl000205_random","pos":3133456858},"chrUn_gl000215":{"id":45,"chr":"chrUn_gl000215","pos":3133631446},"chrUn_gl000216":{"id":46,"chr":"chrUn_gl000216","pos":3133803991},"chrUn_gl000217":{"id":47,"chr":"chrUn_gl000217","pos":3133976285},"chr9_gl000199_random":{"id":48,"chr":"chr9_gl000199_random","pos":3134148434},"chrUn_gl000211":{"id":49,"chr":"chrUn_gl000211","pos":3134318308},"chrUn_gl000213":{"id":50,"chr":"chrUn_gl000213","pos":3134484874},"chrUn_gl000220":{"id":51,"chr":"chrUn_gl000220","pos":3134649113},"chrUn_gl000218":{"id":52,"chr":"chrUn_gl000218","pos":3134810915},"chr19_gl000209_random":{"id":53,"chr":"chr19_gl000209_random","pos":3134972062},"chrUn_gl000221":{"id":54,"chr":"chrUn_gl000221","pos":3135131231},"chrUn_gl000214":{"id":55,"chr":"chrUn_gl000214","pos":3135286628},"chrUn_gl000228":{"id":56,"chr":"chrUn_gl000228","pos":3135424346},"chrUn_gl000227":{"id":57,"chr":"chrUn_gl000227","pos":3135553466},"chr1_gl000191_random":{"id":58,"chr":"chr1_gl000191_random","pos":3135681840},"chr19_gl000208_random":{"id":59,"chr":"chr19_gl000208_random","pos":3135788273},"chr9_gl000198_random":{"id":60,"chr":"chr9_gl000198_random","pos":3135880962},"chr17_gl000204_random":{"id":61,"chr":"chr17_gl000204_random","pos":3135971047},"chrUn_gl000233":{"id":62,"chr":"chrUn_gl000233","pos":3136052357},"chrUn_gl000237":{"id":63,"chr":"chrUn_gl000237","pos":3136098298},"chrUn_gl000230":{"id":64,"chr":"chrUn_gl000230","pos":3136144165},"chrUn_gl000242":{"id":65,"chr":"chrUn_gl000242","pos":3136187856},"chrUn_gl000243":{"id":66,"chr":"chrUn_gl000243","pos":3136231379},"chrUn_gl000241":{"id":67,"chr":"chrUn_gl000241","pos":3136274720},"chrUn_gl000236":{"id":68,"chr":"chrUn_gl000236","pos":3136316872},"chrUn_gl000240":{"id":69,"chr":"chrUn_gl000240","pos":3136358806},"chr17_gl000206_random":{"id":70,"chr":"chr17_gl000206_random","pos":3136400739},"chrUn_gl000232":{"id":71,"chr":"chrUn_gl000232","pos":3136441740},"chrUn_gl000234":{"id":72,"chr":"chrUn_gl000234","pos":3136482392},"chr11_gl000202_random":{"id":73,"chr":"chr11_gl000202_random","pos":3136522923},"chrUn_gl000238":{"id":74,"chr":"chrUn_gl000238","pos":3136563026},"chrUn_gl000244":{"id":75,"chr":"chrUn_gl000244","pos":3136602965},"chrUn_gl000248":{"id":76,"chr":"chrUn_gl000248","pos":3136642894},"chr8_gl000196_random":{"id":77,"chr":"chr8_gl000196_random","pos":3136682680},"chrUn_gl000249":{"id":78,"chr":"chrUn_gl000249","pos":3136721594},"chrUn_gl000246":{"id":79,"chr":"chrUn_gl000246","pos":3136760096},"chr17_gl000203_random":{"id":80,"chr":"chr17_gl000203_random","pos":3136798250},"chr8_gl000197_random":{"id":81,"chr":"chr8_gl000197_random","pos":3136835748},"chrUn_gl000245":{"id":82,"chr":"chrUn_gl000245","pos":3136872923},"chrUn_gl000247":{"id":83,"chr":"chrUn_gl000247","pos":3136909574},"chr9_gl000201_random":{"id":84,"chr":"chr9_gl000201_random","pos":3136945996},"chrUn_gl000235":{"id":85,"chr":"chrUn_gl000235","pos":3136982144},"chrUn_gl000239":{"id":86,"chr":"chrUn_gl000239","pos":3137016618},"chr21_gl000210_random":{"id":87,"chr":"chr21_gl000210_random","pos":3137050442},"chrUn_gl000231":{"id":88,"chr":"chrUn_gl000231","pos":3137078124},"chrUn_gl000229":{"id":89,"chr":"chrUn_gl000229","pos":3137105510},"chrM":{"id":90,"chr":"chrM","pos":3137125423},"chrUn_gl000226":{"id":91,"chr":"chrUn_gl000226","pos":3137141994},"chr18_gl000207_random":{"id":92,"chr":"chr18_gl000207_random","pos":3137157002}},"totalLength":3137161264}')

describe("A search field", function() {
    // 'https://s3.amazonaws.com/pkerp/data/hg19/chromInfo.txt'

    let xScale = d3.scale.linear().domain([0,5000000]).range([0,550]);
    let yScale = d3.scale.linear().domain([0,5000000]).range([0,370]);

    let zoomDispatch = d3.dispatch('zoom');
    let searchField = new SearchField(chromInfo, xScale, yScale, zoomDispatch );

    it ("sould do something", function() {
        let [translate, scale] = searchField.searchPosition('chr1:1000000 to chr1:2000000');

        console.log('translate', translate, 'scale:', scale);
        expect(translate).toEqual([-550, -370]);
        expect(scale).toBe(5);

        [translate, scale] = searchField.searchPosition('chr1:2000000 to chr1:3000000 and chr1:1000000 to chr1:2000000');

        console.log('translate', translate, 'scale:', scale);
        expect(scale).toEqual(5);
        expect(translate).toEqual([-1100,-370]);

    });
});
