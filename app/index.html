<!DOCTYPE html>
<html lang="">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">

    <!--[if lte IE 8]>
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-old-ie-min.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">
    <!--<![endif]-->

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
    
    <script>hljs.initHighlightingOnLoad();</script>

    <title>HiGlass: Multi-resolution Hi-C data display</title>
</head>
<script src="https://rawgit.com/pkerpedjiev/goomba/master/dist/scripts/goomba.js"></script>

<!-- build:css styles/style.css -->
<link rel="stylesheet" href="styles/page.css" />
<!-- endbuild -->

<!-- build:js scripts/higlass.js -->
<script src='scripts/higlass.js'></script>
<!-- endbuild -->

<body>
   <div style="position:relative; padding-left: 25px; padding-top: 14px;  " id="mode">
        <input type="radio" name="debug" value="standard" checked >Standard Mode
        <input type="radio" name="debug" value="debug" style="margin-left: 60px">Debug Mode
        
   </div>

    <div id="mmv-area" style="position:relative; height:550px; width: 700px">

    </div>
    <div id="tooltip" style="position: absolute; background-color: rgba(128,128,128,0.4); padding: 10px; border-radius:10px"></div>
</body>


<script type='text/javascript'>

// style="margin-top: 155px;margin-left: 32px;
    var width, height;
    if(window.innerWidth < window.innerHeight) {
        width = window.innerWidth * 1;
    } else {
        width = window.innerHeight *1.1;
    }
    height = width * 0.8;

    var svg = d3.select('#goombaPlot')
    .attr('width', width)
    .attr('height', 300);

    /*
    // goomba gets drawn with a margin of 30 on the left
    // and a margin of 30 on the right
    // whereas higlass gets drawn with a margin of 30 on the left
    // and 120 on the right
    // thus goomba needs to be 90 smaller
        var goombaPlot = goomba.Goomba()
            .width(width - 90)
            .height(80)

            var gMain = svg.append('g')
            .classed('g-main', true)
            .datum('//s3.amazonaws.com/pkerp/data/hg19/refgene-tiles-small')
            //.datum('jsons/tiles')
            .call(goombaPlot)
    */

var chromInfoFilename = 'https://s3.amazonaws.com/pkerp/data/hg19/chromInfo.txt';
//let awsDomain = '//search-higlass-ssxwuix6kow3sekyeresi7ay5e.us-east-1.es.amazonaws.com';
let awsDomain = '//52.23.165.123:9872';


goomba.ChromosomeInfo(chromInfoFilename, (chromInfo) => {
///////////////////////////
    let mmvMargin = {'top': 30, 'left': 30, 'bottom': 30, 'right': 120};
    var xScale = d3.scale.linear().domain([0, 5000000])
        .range([0, width - mmvMargin.left - mmvMargin.right]);

    var zoomDispatch = d3.dispatch('zoom');

    var mmvPlot1 = higlass.MassiveMatrixPlot()
        .width(width)
        .height(height)
        .nTicks(4)
        .margin(mmvMargin)
        .xDomain(xScale.domain())
        .yDomain(xScale.domain())
        .zoomDispatch(zoomDispatch)

        d3.select('#mmv-area')
        .datum( awsDomain + '/hg19/Rao2014-GM12878-MboI-allreps-filtered.1kb.cool.reduced.genome.5M.gz')
        .call(mmvPlot1)
});
///////////////////////////////////////////////

$(window).resize(function() {
    location.reload();
  //resize just happened, pixels changed
});


</script>
</body>
</html>
