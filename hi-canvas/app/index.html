<!DOCTYPE html>
<html lang="">
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="styles/hi_z.css"/>

    <title>Example</title>
</head>
<body>

<!-- build:js scripts/densityMapping.js -->
<script src='scripts/transfer.js'></script>
<!-- endbuild -->

<!-- build:js scripts/hi_z.js -->
<script src='scripts/hi_z.js'></script>
<!-- endbuild -->

<div id="mmv-area"></div>
<div id="transfer-area"></div>

<script type='text/javascript'>
    // Transfer function editor.
    var transferEditor = new transfer.TransferFunctionEditor(document.getElementById('transfer-area'), 300, 100);

    // Tile view.

    //var server = new hi_z.DataServerDriver();
    var server = new hi_z.FileServer("http://pkerp.s3-website-us-east-1.amazonaws.com/tiles", true);
    var mmv = new hi_z.MatrixView(document.getElementById('mmv-area'), 800, 600, server);
    mmv.dataSet = "chr1_5kb";   //"512k_dense";
    
    // Adjust transfer function domain when data set maximum intensity is known.
    server.dataSetInfo(mmv.dataSet).then(info => {
        transferEditor.domain = [0, info.maxDensity];
    });
    
    // Listen to transfer function changes.
    transferEditor.onChange(tF => {
        mmv.transfer = tF.binnedMap(10000); // Fine-grained transfer bins for better resolution.
    });
    
    // Fit view to browser dimensions.
    //mmv.width = window.innerWidth - 20;
    //mmv.height = window.innerHeight - 20;

    //tileManager.focusOn(new hi_z.MatrixCoordinates(300, 300, 8), 800, 600);
</script>
</body>
</html>
